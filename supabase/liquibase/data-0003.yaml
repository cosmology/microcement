databaseChangeLog:
  - changeSet:
      id: data-0003
      author: microcement-dev
      comment: "Add ivanprokic@yahoo.com user with custom ema.glb scene configuration"
      changes:
        - sql:
            sql: |
              -- Ensure test user 3: ivanprokic@yahoo.com exists (with custom config)
              -- Note: User may already exist from previous migrations, so we use DO NOTHING on email conflict
              INSERT INTO auth.users (
                  id,
                  instance_id,
                  aud,
                  role,
                  email,
                  encrypted_password,
                  email_confirmed_at,
                  recovery_sent_at,
                  last_sign_in_at,
                  raw_app_meta_data,
                  raw_user_meta_data,
                  created_at,
                  updated_at,
                  confirmation_token,
                  email_change,
                  email_change_token_new,
                  recovery_token
              ) VALUES (
                  'f1e2d3c4-b5a6-9780-1234-567890abcdef',
                  '00000000-0000-0000-0000-000000000000',
                  'authenticated',
                  'authenticated',
                  'ivanprokic@yahoo.com',
                  crypt('test12345', gen_salt('bf')),
                  NOW(),
                  NULL,
                  NOW(),
                  '{"provider": "email", "providers": ["email"]}',
                  '{"email": "ivanprokic@yahoo.com", "email_verified": true, "phone_verified": false, "sub": "f1e2d3c4-b5a6-9780-1234-567890abcdef"}',
                  NOW(),
                  NOW(),
                  '',
                  '',
                  '',
                  ''
              ) ON CONFLICT (email) WHERE is_sso_user = false DO NOTHING;

        - sql:
            sql: |
              -- Insert custom scene design config for ivanprokic@yahoo.com with ema.glb
              -- Use the actual existing user ID
              INSERT INTO public.scene_design_configs (
                  id,
                  user_id,
                  config_name,
                  model_path,
                  camera_fov,
                  camera_near,
                  camera_far,
                  orbital_height,
                  orbital_radius_multiplier,
                  orbital_speed,
                  target_size,
                  scale_multiplier,
                  rotation_y,
                  intro_duration,
                  intro_start_pos,
                  intro_end_pos,
                  hotspot_colors,
                  pulse_animation,
                  hotspot_focal_distances,
                  hotspot_categories,
                  look_at_targets,
                  api_hotspot_key_aliases,
                  is_default,
                  created_at,
                  updated_at
              ) VALUES (
                  'd4e5f6a7-b8c9-0123-4567-89abcdef0123',
                  (SELECT id FROM auth.users WHERE email = 'ivanprokic@yahoo.com' LIMIT 1),
                  'ema_showcase',
                  '/models/ema.glb',
                  75,
                  0.1,
                  1000,
                  35,
                  5.5,
                  0.15,
                  25,
                  1.8,
                  1.2,
                  2500,
                  '{"x": 0, "y": 15, "z": 0}',
                  '{"x": -5, "y": 6, "z": 20}',
                  '{"normal": 16711680, "hover": 16744448, "pulse": 16711680}',
                  '{"duration": 1000, "scale": 1.8, "opacity": 0.9}',
                  '{}',
                  '{}',
                  '[]',
                  '{}',
                  true,
                  NOW(),
                  NOW()
              ) ON CONFLICT (id) DO NOTHING;

        - sql:
            sql: |
              -- Insert custom follow paths for the ema.glb scene
              
              -- 1. Main showcase path (active) - different layout for ema model
              INSERT INTO public.scene_follow_paths (
                  id,
                  scene_design_config_id,
                  path_name,
                  camera_points,
                  look_at_targets,
                  is_active,
                  created_at,
                  updated_at
              ) VALUES (
                  'e5f6a7b8-c9d0-1234-5678-9abcdef01234',
                  'd4e5f6a7-b8c9-0123-4567-89abcdef0123',
                  'current',
                  '[
                      {"x": 15, "y": 4, "z": 0},
                      {"x": 8, "y": 5, "z": 3},
                      {"x": 0, "y": 5.5, "z": 8},
                      {"x": -8, "y": 6, "z": 12},
                      {"x": -12, "y": 6.5, "z": 18},
                      {"x": -8, "y": 7, "z": 25},
                      {"x": 0, "y": 7.5, "z": 28},
                      {"x": 8, "y": 8, "z": 25},
                      {"x": 12, "y": 8, "z": 15}
                  ]',
                  '[
                      {"x": 0, "y": 0, "z": 0},
                      {"x": 2, "y": 2, "z": 0},
                      {"x": 4, "y": 3, "z": 0},
                      {"x": 6, "y": 4, "z": 0},
                      {"x": 8, "y": 5, "z": 0},
                      {"x": 10, "y": 6, "z": 0},
                      {"x": 12, "y": 7, "z": 0},
                      {"x": 14, "y": 8, "z": 0},
                      {"x": 16, "y": 9, "z": 0}
                  ]',
                  true,
                  NOW(),
                  NOW()
              ) ON CONFLICT (id) DO NOTHING;

              -- 2. Bedroom area path (inactive)
              INSERT INTO public.scene_follow_paths (
                  id,
                  scene_design_config_id,
                  path_name,
                  camera_points,
                  look_at_targets,
                  is_active,
                  created_at,
                  updated_at
              ) VALUES (
                  'f6a7b8c9-d0e1-2345-6789-abcdef012345',
                  'd4e5f6a7-b8c9-0123-4567-89abcdef0123',
                  'bedroom_area',
                  '[
                      {"x": 15, "y": 4, "z": 0},
                      {"x": 12, "y": 4.5, "z": -3},
                      {"x": 8, "y": 5, "z": -6},
                      {"x": 4, "y": 5.5, "z": -8},
                      {"x": 0, "y": 6, "z": -10},
                      {"x": -4, "y": 6.5, "z": -8},
                      {"x": -8, "y": 7, "z": -6},
                      {"x": -12, "y": 7.5, "z": -3},
                      {"x": -15, "y": 8, "z": 0}
                  ]',
                  '[
                      {"x": 0, "y": 0, "z": 0},
                      {"x": -2, "y": 1, "z": -2},
                      {"x": -4, "y": 2, "z": -4},
                      {"x": -6, "y": 3, "z": -6},
                      {"x": -8, "y": 4, "z": -8},
                      {"x": -6, "y": 5, "z": -6},
                      {"x": -4, "y": 6, "z": -4},
                      {"x": -2, "y": 7, "z": -2},
                      {"x": 0, "y": 8, "z": 0}
                  ]',
                  false,
                  NOW(),
                  NOW()
              ) ON CONFLICT (id) DO NOTHING;

              -- 3. Office space path (inactive)
              INSERT INTO public.scene_follow_paths (
                  id,
                  scene_design_config_id,
                  path_name,
                  camera_points,
                  look_at_targets,
                  is_active,
                  created_at,
                  updated_at
              ) VALUES (
                  'a7b8c9d0-e1f2-3456-789a-bcdef0123456',
                  'd4e5f6a7-b8c9-0123-4567-89abcdef0123',
                  'office_space',
                  '[
                      {"x": 15, "y": 4, "z": 0},
                      {"x": 10, "y": 4.5, "z": 5},
                      {"x": 5, "y": 5, "z": 10},
                      {"x": 0, "y": 5.5, "z": 15},
                      {"x": -5, "y": 6, "z": 20},
                      {"x": -10, "y": 6.5, "z": 25},
                      {"x": -15, "y": 7, "z": 30},
                      {"x": -10, "y": 7.5, "z": 25},
                      {"x": -5, "y": 8, "z": 20}
                  ]',
                  '[
                      {"x": 0, "y": 0, "z": 0},
                      {"x": 3, "y": 1, "z": 3},
                      {"x": 6, "y": 2, "z": 6},
                      {"x": 9, "y": 3, "z": 9},
                      {"x": 12, "y": 4, "z": 12},
                      {"x": 15, "y": 5, "z": 15},
                      {"x": 18, "y": 6, "z": 18},
                      {"x": 15, "y": 7, "z": 15},
                      {"x": 12, "y": 8, "z": 12}
                  ]',
                  false,
                  NOW(),
                  NOW()
              ) ON CONFLICT (id) DO NOTHING;
